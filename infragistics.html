<!DOCTYPE html>
<html>    
    <head>    

        <title>igSpreadsheet Conditional Formatting</title>

	<!--<link href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet" />-->
	<link href="https://cdn-na.infragistics.com/igniteui/2023.1/latest/css/themes/infragistics/infragistics.theme.css" rel="stylesheet" />
	<link href="https://cdn-na.infragistics.com/igniteui/2023.1/latest/css/structure/infragistics.css" rel="stylesheet" />

	<script src="https://ajax.aspnetcdn.com/ajax/modernizr/modernizr-2.8.3.js"></script>
	<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="https://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
	<script src="/data.js"></script>
    
	<!-- Ignite UI for jQuery Required Combined JavaScript Files -->
	<script src="https://cdn-na.infragistics.com/igniteui/2023.1/latest/js/infragistics.core.js"></script>
	<script src="https://cdn-na.infragistics.com/igniteui/2023.1/latest/js/infragistics.lob.js"></script>
	<script src="https://cdn-na.infragistics.com/igniteui/2023.1/latest/js/infragistics.excel-bundled.js"></script>
	<script src="https://cdn-na.infragistics.com/igniteui/2023.1/latest/js/infragistics.spreadsheet-bundled.js"></script>      

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
    
    <style>
        .bg-test{
            background-color: rgb(237, 237, 237);
        }
        .bg-blue{
            background-color: rgb(203, 236, 240);
        }
        .btn-search{
            border: solid 1px grey;
            display: grid;
            place-items: center;
        }
    </style>
</head>

<body class="bg-test">
    <div class="container-fluid">
        <div>
        </div>
        <div class="row mx-5 my-5">
            <div class="col-12">
                <div class="col-6">
                    <div class="row g-3 align-items-center my-1">
                        <div class="col-2">
                          <label for="" class="col-form-label">Project ID </label>
                        </div>
                        <div class="col-auto">:</div>
                        <div class="col-auto">
                          <input type="password" id="" class="form-control" aria-describedby="passwordHelpInline">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="row g-3 align-items-center my-1">
                    <div class="col-2">
                      <label for="" class="col-form-label">Daily Plan ID </label>
                    </div>
                    <div class="col-auto">:</div>
                    <div class="col-auto">
                      <input type="password" id="" class="form-control" aria-describedby="passwordHelpInline">
                    </div>
                </div>
    
                <div class="row g-3 align-items-center my-1">
                    <div class="col-2">
                      <label for="" class="col-form-label">Supervisor </label>
                    </div>
                    <div class="col-auto">:</div>
                    <div class="col-auto">
                      <input type="password" id="" class="form-control bg-blue" aria-describedby="passwordHelpInline">
                    </div>
                    <div class="col-1">
                        <button class="btn btn-light">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                    </div>
                </div>
    
                <div class="row g-3 align-items-center my-1">
                    <div class="col-2">
                      <label for="" class="col-form-label">Foreman </label>
                    </div>
                    <div class="col-auto">:</div>
                    <div class="col-auto">
                      <input type="password" id="" class="form-control bg-blue" aria-describedby="passwordHelpInline">
                    </div>
                    <div class="col-1">
                        <button class="btn btn-light">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="row g-3 align-items-center my-1">
                    <div class="col-3">
                      <label for="" class="col-form-label">Actual Prod. ID </label>
                    </div>
                    <div class="col-auto">:</div>
                    <div class="col-auto">
                      <input type="password" id="" class="form-control" aria-describedby="passwordHelpInline">
                    </div>
                </div>
    
                <div class="row g-3 align-items-center my-1">
                    <div class="col-3">
                      <label for="" class="col-form-label">Date </label>
                    </div>
                    <div class="col-auto">:</div>
                    <div class="col-auto">
                      <input type="date" id="" class="form-control" aria-describedby="passwordHelpInline">
                    </div>
                </div>
    
                <div class="row g-3 align-items-center my-1">
                    <div class="col-3">
                      <label for="" class="col-form-label">Shift </label>
                    </div>
                    <div class="col-auto">:</div>
                    <div class="col-auto">
                      <input type="password" id="" class="form-control" aria-describedby="passwordHelpInline">
                    </div>
                </div>
            </div>
            <div class="col-12">
                <div class="row g-3 align-items-center my-1">
                    <div class="col-1">
                      <label for="" class="col-form-label">Notes </label>
                    </div>
                    <div class="col-auto">:</div>
                    <div class="col-9">
                      <textarea type="password" id="" class="form-control" aria-describedby="passwordHelpInline"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <!-- <input class="spreadsheet-sample-btn" id="createWorkbookBtn" type="button" value="Generate Workbook" onclick="createWorkbook()">             -->
            <div id="spreadsheet"></div>
        </div>
    </div>
    <script>
        var current_cell = 1;
        $(function () {
        var editingEnabled = true;
            //Initializing igSpreadsheet
            $("#spreadsheet").igSpreadsheet({
                height: "400",
                width: "100%",
                isFormulaBarVisible: true,
                editModeEntering: function (e, args) {
                    return editingEnabled;
                }
            });             
            createWorkbook()
        });
    
            //display the workbook via igSpreadsheet
            function loadWorkbook(workbook) {
                $("#spreadsheet").igSpreadsheet("option", "workbook", workbook);
            }

            function generateHeader2(data,current_cell,sheet){
                data.forEach((e,i) => {
                    let ALFA = (i+10).toString(36)
                    let cell = ALFA + (current_cell)
                    var cells = sheet.getCell(cell);
                    sheet.columns(i).width(6000);
                    cells.cellFormat().fill($.ig.excel.CellFill.createSolidFill("blue"));
                    cells.cellFormat().font().colorInfo(new $.ig.excel.WorkbookColorInfo("white")); 
                    cells.value(e);
                });
            }

            function generateDataHeader2(data,current_cell,sheet,headers2){
                //let len = Object.keys(data).length-1
                data.forEach(data=>{
                    let i = 0
                    for (const key in data){
                        if(key != "data"){
                            let ALFA = (i+10).toString(36)
                            let cell = ALFA + (current_cell)
                            var cells = sheet.getCell(cell);
                            if(i==0){
                                cells.cellFormat().fill($.ig.excel.CellFill.createSolidFill("blue"));
                            }else{
                                sheet.columns(i).width(6000);
                                cells.value(data[key]);
                            }
                            i++
                        }
                    }
                    current_cell++
                    generateHeader2(headers2,current_cell,sheet)
                    current_cell++
                    let j = 0
                    data.data.forEach((e,i)=>{
                        for (const key in e){
                            let ALFA = (j+10).toString(36)
                            let cell = ALFA + (current_cell)
                            console.log(cell)
                            var cells = sheet.getCell(cell);
                            if(j<=1){
                                cells.cellFormat().fill($.ig.excel.CellFill.createSolidFill("blue"));
                            }else{
                                sheet.columns(i).width(6000);
                                cells.value(e[key]);
                            }
                            j++
                        }
                        j=0
                        current_cell++
                    })
                })

            }
            
            function createWorkbook() {
                var workbook = new $.ig.excel.Workbook($.ig.excel.WorkbookFormat.excel2007);
                var sheet = workbook.worksheets().add('Production Activity');
                var letters = ["A", "B", "C", "D", "E", "F", "G","H","I","J","K","L","M","N","O"]
                var headers = mainHeader.map(a=>{return a.value})
                var headers2 = secondHeader.map(a=>{return a.value})
                var skus = ["401043204-423","534041202-345","601041205-784","51041204-426","41041204-427","31041204-428","21041204-429","41041204-430","61022204-431","11043204-432","41041204-433","21041204-434","401043204-423","31041204-436","21041204-437"]
                var names = ["Guaraná Fantástica","NuNuCa Nuß-Nougat-Creme","Gumbär Gummibärchen","Schoggi Schokolade","Rössle Sauerkraut","","Nord-Ost Matjeshering","Gorgonzola Telino","Mascarpone Fabioli","Geitost","Sasquatch Ale","","Inlagd Sill","Gravad lax"]
                var categories = ["Grains/Cereals","Beverages","Confections","Confections","Confections","Produce","Meat/Poultry","Seafood","Dairy Products","Dairy Products","Dairy Products","Beverages","Beverages","Seafood","Seafood"]
                var suppliers = ["PB Knäckebröd AB","Refrescos Americanas LTDA","Heli Süßwaren GmbH & Co. KG","Heli Süßwaren GmbH & Co. KG","Heli Süßwaren GmbH & Co. KG","Plutzer Lebensmittelgroßmärkte AG","Plutzer Lebensmittelgroßmärkte AG","Nord-Ost-Fisch Handelsgesellschaft mbH","Formaggi Fortini s.r.l.","Formaggi Fortini s.r.l.","Norske Meierier","Bigfoot Breweries","Bigfoot Breweries","Svensk Sjöföda AB","Svensk Sjöföda AB"]                
                headers.forEach((e,i) => {
                    let ALFA = (i+10).toString(36)
                    let cell = ALFA + (1)
                    var cells = sheet.getCell(cell);
                    sheet.columns(i).width(6000);
                    cells.value(e);
                    cells.cellFormat().fill($.ig.excel.CellFill.createSolidFill("blue"));
                    cells.cellFormat().font().colorInfo(new $.ig.excel.WorkbookColorInfo("white"));  
                });
                current_cell++
                generateDataHeader2(DATAX,current_cell,sheet,headers2)


                // var duplicateCondition = sheet.conditionalFormats().addDuplicateCondition("A2:A15");
                // duplicateCondition.cellFormat().font().colorInfo(new $.ig.excel.WorkbookColorInfo("red"));
                // duplicateCondition.cellFormat().fill($.ig.excel.CellFill.createSolidFill("blue"));

                // var blanksCondition = sheet.conditionalFormats().addBlanksCondition("B2:B15");
                // blanksCondition.cellFormat().fill($.ig.excel.CellFill.createSolidFill("gray"));

                // var textCondition = sheet.conditionalFormats().addTextCondition("C2:C15", "Bev");
                // textCondition.cellFormat().font().colorInfo(new $.ig.excel.WorkbookColorInfo("blue"));

                // var uniqueCondition = sheet.conditionalFormats().addUniqueCondition("D2:D15");
                // uniqueCondition.cellFormat().font().colorInfo(new $.ig.excel.WorkbookColorInfo("orange"));                

                // var operatorCondition1 = sheet.conditionalFormats().addOperatorCondition("E2:E15");
                // operatorCondition1.setOperand1("TRUE");
                // operatorCondition1.cellFormat().font().colorInfo(new $.ig.excel.WorkbookColorInfo("green"));

                // var operatorCondition2 = sheet.conditionalFormats().addOperatorCondition("E2:E15");
                // operatorCondition2.setOperand1("FALSE");
                // operatorCondition2.cellFormat().font().colorInfo(new $.ig.excel.WorkbookColorInfo("red"));

                // sheet.conditionalFormats().addDataBarCondition("F2:F15");

                // var avgCondition = sheet.conditionalFormats().addAverageCondition("G2:G15");
                // avgCondition.cellFormat().font().colorInfo(new $.ig.excel.WorkbookColorInfo("red"));

                loadWorkbook(workbook);              
            }

            function getRandomBetween(min, max){
                return Math.floor(Math.random() * (max - min + 1)) + min;
            }
        </script>
    </body>
</html>